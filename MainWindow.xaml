<Window x:Class="SyncManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sync Manager" Height="900" Width="1200"
        WindowStartupLocation="CenterScreen"
        Closing="Window_Closing">
    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#106EBE"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#005A9E"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style TargetType="TextBlock" x:Key="HeaderStyle">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
    </Window.Resources>
    
    <DockPanel LastChildFill="True">
        <!-- Title Bar -->
        <StackPanel DockPanel.Dock="Top" Background="#F3F3F3" Margin="20">
            <TextBlock Text="Folder Sync Manager" FontSize="24" FontWeight="Bold" Foreground="#0078D4"/>
            <TextBlock Text="Automated backup with version history" FontSize="12" Foreground="#666" Margin="0,5,0,0"/>
        </StackPanel>
        
        <!-- Tabs -->
        <TabControl DockPanel.Dock="Top" Margin="0">
            <!-- Tab 1: Sync Profiles -->
            <TabItem Header="ðŸ“‹ Sync Profiles">
                <DockPanel LastChildFill="True">
                    <!-- Profile List -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20">
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="Active Sync Profiles"/>
                        
                        <DataGrid x:Name="ProfilesDataGrid" Height="300" AutoGenerateColumns="False"
                                  CanUserAddRows="False" CanUserDeleteRows="False" CanUserResizeRows="False"
                                  CellEditEnding="ProfilesDataGrid_CellEditEnding">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Profile Name" Binding="{Binding Name}" Width="150"/>
                                <DataGridTextColumn Header="Source" Binding="{Binding SourceFolder}" Width="200"/>
                                <DataGridTextColumn Header="Destination" Binding="{Binding DestinationFolder}" Width="200"/>
                                <DataGridTextColumn Header="Backups" Binding="{Binding BackupVersions}" Width="70"/>
                                <DataGridCheckBoxColumn Header="Auto-Sync" Binding="{Binding AutoSyncEnabled, UpdateSourceTrigger=PropertyChanged}" Width="80"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTemplateColumn Header="Actions" Width="200">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="Sync Now" Click="SyncNow_Click" Padding="8,4" FontSize="11"/>
                                                <Button Content="Edit" Click="EditProfile_Click" Padding="8,4" FontSize="11" Background="#17A2B8"/>
                                                <Button Content="Delete" Click="DeleteProfile_Click" Padding="8,4" FontSize="11" Background="#DC3545"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                    
                    <!-- Add Profile Section -->
                    <StackPanel DockPanel.Dock="Bottom" Margin="0,20,0,0">
                        <Border BorderBrush="#DDD" BorderThickness="1" Padding="20" Background="#F9F9F9">
                            <StackPanel>
                                <TextBlock Style="{StaticResource HeaderStyle}" Text="Create New Sync Profile"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Profile Name -->
                                    <TextBlock Text="Profile Name:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBox x:Name="ProfileNameTextBox" Grid.Column="1" Width="300" Padding="10" Margin="0,0,0,10"/>
                                    
                                    <!-- Source Folder -->
                                    <TextBlock Grid.Row="1" Text="Source Folder:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <Grid Grid.Row="1" Grid.Column="1" Margin="0,0,0,10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="SourceFolderTextBox" Padding="10"/>
                                        <Button Content="Browse" Grid.Column="1" Click="BrowseSource_Click" Width="100" Margin="10,0,0,0"/>
                                    </Grid>
                                    
                                    <!-- Destination Folder -->
                                    <TextBlock Grid.Row="2" Text="Destination Folder:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <Grid Grid.Row="2" Grid.Column="1" Margin="0,0,0,10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="DestFolderTextBox" Padding="10"/>
                                        <Button Content="Browse" Grid.Column="1" Click="BrowseDestination_Click" Width="100" Margin="10,0,0,0"/>
                                    </Grid>

                                    <!-- Backup Folder -->
                                    <TextBlock Grid.Row="3" Text="Backup Folder:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <Grid Grid.Row="3" Grid.Column="1" Margin="0,0,0,10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox x:Name="BackupFolderTextBox" Padding="10" Text="{Binding DefaultBackupFolder, Mode=OneTime}"/>
                                        <Button Content="Browse" Grid.Column="1" Click="BrowseBackup_Click" Width="100" Margin="10,0,0,0"/>
                                    </Grid>

                                    <!-- Backup Versions -->
                                    <TextBlock Grid.Row="4" Text="Backup Versions:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBox x:Name="BackupVersionsTextBox" Grid.Row="4" Grid.Column="1" Width="300" Padding="10" Text="3" Margin="0,0,0,10"/>

                                    <!-- Auto-Sync Checkbox -->
                                    <CheckBox x:Name="AutoSyncCheckBox" Grid.Row="5" Grid.Column="1" Content="Enable Auto-Sync (monitor folder for changes)" Margin="0,0,0,10" IsChecked="True"/>

                                    <!-- Buttons -->
                                    <StackPanel Grid.Row="6" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Button Content="Create Profile" Click="CreateProfile_Click" Width="120"/>
                                        <Button Content="Test Dry-Run" Click="TestDryRun_Click" Width="120" Background="#28A745"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </DockPanel>
            </TabItem>
            
            <!-- Tab 2: Sync Now -->
            <TabItem Header="âš¡ Sync Now">
                <DockPanel LastChildFill="True">
                    <!-- Profile Selection -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20">
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="Select Profile to Sync"/>
                        <ComboBox x:Name="SyncProfileComboBox" Height="35" Padding="10" FontSize="12"/>
                    </StackPanel>
                    
                    <!-- Sync Options -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20">
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="Sync Options"/>
                        <CheckBox x:Name="DryRunCheckBox" Content="Dry Run (preview changes without applying)" Margin="0,0,0,10"/>
                        <CheckBox x:Name="ShowDetailsCheckBox" Content="Show detailed output" IsChecked="True" Margin="0,0,0,10"/>
                    </StackPanel>
                    
                    <!-- Sync Button -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20" Orientation="Horizontal">
                        <Button x:Name="StartSyncButton" Content="â–¶ Start Sync" Width="150" Height="40" FontSize="13" Click="StartSync_Click"/>
                        <Button x:Name="CancelSyncButton" Content="â¹ Cancel" Width="150" Height="40" FontSize="13" Background="#DC3545" Click="CancelSync_Click" IsEnabled="False"/>
                    </StackPanel>
                    
                    <!-- Progress Bar -->
                    <ProgressBar x:Name="SyncProgressBar" DockPanel.Dock="Top" Height="25" Margin="0,0,0,20" 
                                 Foreground="#0078D4" IsIndeterminate="True" Visibility="Collapsed"/>
                    
                    <!-- Status Info -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20">
                        <TextBlock x:Name="SyncStatusText" FontSize="12" Foreground="#666"/>
                        <TextBlock x:Name="SyncDetailText" FontSize="11" Foreground="#999" Margin="0,5,0,0"/>
                    </StackPanel>
                    
                    <!-- Output Log -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,0">
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="Sync Output"/>
                        <TextBox x:Name="SyncOutputTextBox" Height="400" Padding="10" IsReadOnly="True" 
                                 Background="#F5F5F5" VerticalScrollBarVisibility="Auto" FontFamily="Consolas" FontSize="10"/>
                    </StackPanel>
                </DockPanel>
            </TabItem>
            
            <!-- Tab 3: Scheduled Tasks -->
            <TabItem Header="ðŸ• Scheduled Tasks">
                <DockPanel LastChildFill="True">
                    <!-- Task List -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20">
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="Scheduled Sync Tasks"/>
                        
                        <DataGrid x:Name="TasksDataGrid" Height="300" AutoGenerateColumns="False" 
                                  CanUserAddRows="False" CanUserDeleteRows="False" CanUserResizeRows="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Task Name" Binding="{Binding TaskName}" Width="200"/>
                                <DataGridTextColumn Header="Profile" Binding="{Binding ProfileName}" Width="150"/>
                                <DataGridTextColumn Header="Frequency" Binding="{Binding Frequency}" Width="120"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTextColumn Header="Last Run" Binding="{Binding LastRun}" Width="150"/>
                                <DataGridTemplateColumn Header="Actions" Width="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="Run Now" Click="RunTask_Click" Padding="8,4" FontSize="11"/>
                                                <Button Content="Delete" Click="DeleteTask_Click" Padding="8,4" FontSize="11" Background="#DC3545"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                    
                    <!-- Create Task Section -->
                    <StackPanel DockPanel.Dock="Bottom" Margin="0,20,0,0">
                        <Border BorderBrush="#DDD" BorderThickness="1" Padding="20" Background="#F9F9F9">
                            <StackPanel>
                                <TextBlock Style="{StaticResource HeaderStyle}" Text="Create Scheduled Task"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Task Name -->
                                    <TextBlock Text="Task Name:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="TaskNameTextBox" Grid.Column="1" Padding="10" Margin="0,0,0,10"/>
                                    
                                    <!-- Profile -->
                                    <TextBlock Grid.Row="1" Text="Select Profile:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="TaskProfileComboBox" Grid.Row="1" Grid.Column="1" Padding="10" Margin="0,0,0,10"/>
                                    
                                    <!-- Frequency -->
                                    <TextBlock Grid.Row="2" Text="Frequency:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="TaskFrequencyComboBox" Grid.Row="2" Grid.Column="1" Padding="10" Margin="0,0,0,10">
                                        <ComboBoxItem>Every Minute</ComboBoxItem>
                                        <ComboBoxItem>Every 5 Minutes</ComboBoxItem>
                                        <ComboBoxItem>Every 15 Minutes</ComboBoxItem>
                                        <ComboBoxItem>Every 30 Minutes</ComboBoxItem>
                                        <ComboBoxItem>Every Hour</ComboBoxItem>
                                        <ComboBoxItem>Daily (2:00 AM)</ComboBoxItem>
                                    </ComboBox>
                                    
                                    <!-- Buttons -->
                                    <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Button Content="Create Task" Click="CreateTask_Click" Width="120"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </DockPanel>
            </TabItem>
            
            <!-- Tab 4: Activity Log -->
            <TabItem Header="ðŸ“Š Activity Log">
                <DockPanel LastChildFill="True">
                    <!-- Filter Controls -->
                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20" Orientation="Horizontal">
                        <ComboBox x:Name="LogFilterComboBox" Width="150" Padding="10">
                            <ComboBoxItem IsSelected="True">All</ComboBoxItem>
                            <ComboBoxItem>INFO</ComboBoxItem>
                            <ComboBoxItem>SUCCESS</ComboBoxItem>
                            <ComboBoxItem>WARNING</ComboBoxItem>
                            <ComboBoxItem>ERROR</ComboBoxItem>
                        </ComboBox>
                        <Button Content="Clear Logs" Click="ClearLogs_Click" Width="100"/>
                        <Button Content="Refresh" Click="RefreshLogs_Click" Width="100"/>
                    </StackPanel>
                    
                    <!-- Log Display -->
                    <DataGrid x:Name="LogDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp}" Width="150"/>
                            <DataGridTextColumn Header="Level" Binding="{Binding Level}" Width="80"/>
                            <DataGridTextColumn Header="Profile" Binding="{Binding ProfileName}" Width="150"/>
                            <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </TabItem>
            
            <!-- Tab 5: Settings -->
            <TabItem Header="âš™ï¸ Settings">
                <ScrollViewer>
                    <StackPanel Margin="20">
                        <!-- General Settings -->
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="General Settings"/>
                        <CheckBox x:Name="StartMinimizedCheckBox" Content="Start minimized to system tray" Margin="0,0,0,10"/>
                        <CheckBox x:Name="MinimizeToTrayCheckBox" Content="Minimize to system tray (not taskbar)" Margin="0,0,0,10"/>
                        <CheckBox x:Name="EnableNotificationsCheckBox" Content="Show system notifications on sync complete" IsChecked="True" Margin="0,0,0,20"/>
                        
                        <!-- Backup Settings -->
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="Backup Settings"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                            <TextBlock Text="Default backup versions:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox x:Name="DefaultBackupVersionsTextBox" Width="100" Padding="8" Text="3"/>
                        </StackPanel>
                        
                        <!-- Exclusion Patterns -->
                        <TextBlock Style="{StaticResource HeaderStyle}" Text="File Exclusion Patterns (one per line)"/>
                        <TextBox x:Name="ExclusionPatternsTextBox" Height="150" Padding="10" VerticalScrollBarVisibility="Auto" 
                                 Text="\.sync-metadata\.json&#10;\.backups&#10;System Volume Information&#10;Thumbs\.db&#10;~*&#10;\.tmp"/>
                        
                        <!-- Save Button -->
                        <Button Content="Save Settings" Click="SaveSettings_Click" Width="150" Margin="0,20,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
